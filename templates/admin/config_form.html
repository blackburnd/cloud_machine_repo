{% extends "base.html" %}

{% block title %}{{ category_info.title }} Configuration - Admin{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="config-header">
        <div class="breadcrumb">
            <a href="/admin/config">‚Üê Back to Configuration</a>
        </div>
        
        <div class="category-title">
            <div class="category-icon">{{ category_info.icon }}</div>
            <div>
                <h1>{{ category_info.title }}</h1>
                <p>{{ category_info.description }}</p>
            </div>
        </div>
    </div>

    {% if request.args.get('success') %}
    <div class="alert alert-success">
        ‚úÖ Successfully updated {{ request.args.get('updated', '0') }} configuration values!
    </div>
    {% endif %}

    {% if request.args.get('reset') %}
    <div class="alert alert-info">
        üîÑ Reset {{ request.args.get('count', '0') }} configuration values to defaults.
    </div>
    {% endif %}

    {% if request.args.get('error') %}
    <div class="alert alert-danger">
        ‚ùå Error occurred during configuration update. Please try again.
    </div>
    {% endif %}

    <form method="POST" class="config-form">
        {% for config_key in category_info.configs %}
        <div class="form-group">
            <label for="{{ config_key }}">
                {{ config_key.replace('_', ' ').title() }}
            </label>
            
            {% if config_key.endswith('_text') or config_key.endswith('_description') or config_key.endswith('_bio') %}
            <textarea 
                id="{{ config_key }}" 
                name="{{ config_key }}" 
                rows="4"
                placeholder="Enter {{ config_key.replace('_', ' ').lower() }}..."
            >{{ current_values.get(config_key, '') }}</textarea>
            {% elif config_key.endswith('_url') %}
            <input 
                type="url" 
                id="{{ config_key }}" 
                name="{{ config_key }}" 
                value="{{ current_values.get(config_key, '') }}"
                placeholder="https://example.com"
            />
            {% elif config_key.endswith('_email') or config_key == 'email' %}
            <input 
                type="email" 
                id="{{ config_key }}" 
                name="{{ config_key }}" 
                value="{{ current_values.get(config_key, '') }}"
                placeholder="email@example.com"
            />
            {% elif config_key.endswith('_phone') or config_key == 'phone' %}
            <input 
                type="tel" 
                id="{{ config_key }}" 
                name="{{ config_key }}" 
                value="{{ current_values.get(config_key, '') }}"
                placeholder="+1 (555) 123-4567"
            />
            {% else %}
            <input 
                type="text" 
                id="{{ config_key }}" 
                name="{{ config_key }}" 
                value="{{ current_values.get(config_key, '') }}"
                placeholder="Enter {{ config_key.replace('_', ' ').lower() }}..."
            />
            {% endif %}
            
            <div class="field-help">
                {% if config_key == 'full_name' %}
                Your full name as it should appear on the site
                {% elif config_key == 'professional_title' %}
                Your job title or professional description
                {% elif config_key == 'nav_work_label' %}
                Label for the work/portfolio link in navigation
                {% elif config_key == 'nav_projects_label' %}
                Label for the projects link in navigation
                {% elif config_key == 'site_title' %}
                Main title that appears in browser tab and page headers
                {% elif config_key == 'company_name' %}
                Your company or personal brand name
                {% elif config_key.endswith('_url') %}
                Full URL including https://
                {% elif config_key.endswith('_email') %}
                Valid email address for contact forms
                {% else %}
                Configuration value for {{ config_key.replace('_', ' ').lower() }}
                {% endif %}
            </div>
        </div>
        {% endfor %}

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                üíæ Save {{ category_info.title }}
            </button>
            
            <a href="/admin/config/{{ category }}/reset" 
               class="btn btn-outline btn-warning"
               onclick="return confirm('Reset all {{ category_info.title.lower() }} settings to defaults?')">
                üîÑ Reset to Defaults
            </a>
            
            <a href="/admin/config" class="btn btn-outline">
                ‚Üê Back to Overview
            </a>
        </div>
    </form>

    <div class="config-preview">
        <h3>üîç Current Values Preview</h3>
        <div class="preview-grid">
            {% for config_key in category_info.configs %}
            <div class="preview-item">
                <div class="preview-key">{{ config_key.replace('_', ' ').title() }}</div>
                <div class="preview-value">
                    {% if current_values.get(config_key) %}
                        {{ current_values.get(config_key)[:100] }}
                        {% if current_values.get(config_key)|length > 100 %}...{% endif %}
                    {% else %}
                        <em>Not configured</em>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
.admin-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

.config-header {
    margin-bottom: 30px;
}

.breadcrumb {
    margin-bottom: 15px;
}

.breadcrumb a {
    color: #3498db;
    text-decoration: none;
    font-size: 0.9em;
}

.breadcrumb a:hover {
    text-decoration: underline;
}

.category-title {
    display: flex;
    align-items: center;
    gap: 15px;
}

.category-icon {
    font-size: 2.5em;
}

.category-title h1 {
    margin: 0 0 5px 0;
    color: #2c3e50;
}

.category-title p {
    margin: 0;
    color: #7f8c8d;
    font-size: 1.1em;
}

.config-form {
    background: white;
    border: 1px solid #e1e8ed;
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 30px;
}

.form-group {
    margin-bottom: 25px;
}

.form-group label {
    display: block;
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 8px;
    font-size: 0.95em;
}

.form-group input,
.form-group textarea {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 0.95em;
    transition: all 0.3s ease;
    box-sizing: border-box;
}

.form-group input:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.field-help {
    font-size: 0.8em;
    color: #7f8c8d;
    margin-top: 5px;
    font-style: italic;
}

.form-actions {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    align-items: center;
    padding-top: 20px;
    border-top: 1px solid #e1e8ed;
}

.btn {
    padding: 12px 20px;
    border-radius: 8px;
    text-decoration: none;
    font-size: 0.95em;
    font-weight: 500;
    border: 1px solid;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 5px;
}

.btn-primary {
    background: #3498db;
    color: white;
    border-color: #3498db;
}

.btn-primary:hover {
    background: #2980b9;
    border-color: #2980b9;
}

.btn-outline {
    background: white;
    color: #6c757d;
    border-color: #ddd;
}

.btn-outline:hover {
    background: #f8f9fa;
    border-color: #adb5bd;
}

.btn-warning {
    color: #f39c12;
    border-color: #f39c12;
}

.btn-warning:hover {
    background: #f39c12;
    color: white;
}

.config-preview {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 25px;
}

.config-preview h3 {
    margin: 0 0 20px 0;
    color: #2c3e50;
}

.preview-grid {
    display: grid;
    gap: 15px;
}

.preview-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 12px 0;
    border-bottom: 1px solid #e1e8ed;
}

.preview-item:last-child {
    border-bottom: none;
}

.preview-key {
    font-weight: 500;
    color: #2c3e50;
    min-width: 200px;
    font-size: 0.9em;
}

.preview-value {
    color: #7f8c8d;
    text-align: right;
    flex: 1;
    font-size: 0.85em;
    word-break: break-word;
}

.preview-value em {
    color: #bdc3c7;
}

.alert {
    padding: 15px 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    font-weight: 500;
}

.alert-success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-info {
    background: #d1ecf1;
    color: #0c5460;
    border: 1px solid #bee5eb;
}

.alert-danger {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

@media (max-width: 768px) {
    .category-title {
        flex-direction: column;
        align-items: flex-start;
        text-align: left;
    }
    
    .form-actions {
        flex-direction: column;
        align-items: stretch;
    }
    
    .btn {
        text-align: center;
        justify-content: center;
    }
    
    .preview-item {
        flex-direction: column;
        gap: 5px;
    }
    
    .preview-key {
        min-width: auto;
    }
    
    .preview-value {
        text-align: left;
    }
}
</style>
{% endblock %}
