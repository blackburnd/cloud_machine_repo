<!DOCTYPE html>
<html
    class="no-js wf-freightsanspro-n3-active wf-freightsanspro-n9-active wf-freightsanspro-n4-active wf-freightsanspro-i9-active wf-freightdisplaypro-n7-active wf-freightdisplaypro-i7-active wf-active">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ title }}</title>
    <script src="//ajax.googleapis.com/ajax/libs/dojo/1.14.1/dojo/dojo.js"></script>
    <script src="/assets/js/auth-login.js?v=20250911"></script>
    <link rel="stylesheet" href="/assets/style.css">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-27877508-5');
    </script>
</head>

<body class="work">
    <div class="wrap">
        <div class="fg">
            <!-- Include the navigation component with current page set to 'work' -->
            {% with current_page='work', user=user_info, user_authenticated=user_authenticated, user_email=user_email %}
                {% include 'navigation.html' %}
            {% endwith %}
            <div id="bw" aria-live="polite">
                <article class="bc clearfix">
                    <section class="work-content">
                        <h2>My Work</h2>
                        <p>Here's a collection of my professional experience and selected projects. I specialize in cloud technologies, automation, and modern web development.</p>

                        <!-- Technical Showcase Section -->
                        <div class="technical-showcase">
                            <h3>Technical Showcase: This Portfolio Site</h3>
                            <p>As an academic exercise born from the need to advocate for my skillset beyond what a simple resume could offer, I created this OAuth2-authenticating, LinkedIn-integrated site. This project allowed me to immerse myself in modern web development technologies and cloud infrastructure.</p>
                            <p>This portfolio site demonstrates my technical proficiency through:</p>
                            <ul>
                                <li><strong>Backend:</strong> Python with FastAPI framework for high-performance, async API development</li>
                                <li><strong>API:</strong> GraphQL for flexible, efficient data querying and manipulation</li>
                                <li><strong>Database:</strong> PostgreSQL on Google Cloud SQL for robust data persistence</li>
                                <li><strong>Authentication:</strong> Custom OAuth2 implementation for Google and LinkedIn integration</li>
                                <li><strong>Frontend:</strong> Modern HTML5, CSS3, and vanilla JavaScript for a fast, responsive experience</li>
                                <li><strong>Cloud Infrastructure:</strong> Google Compute Engine VM with Nginx as reverse proxy</li>
                                <li><strong>DevOps:</strong> Continuous Integration/Continuous Deployment via GitHub Actions and Google Cloud Build</li>
                                <li><strong>Development:</strong> VS Code with GitHub Copilot for AI-assisted coding</li>
                                <li><strong>Security:</strong> SSL/TLS encryption, secure cookie handling, and proper credential management</li>
                            </ul>
                            <p>The entire solution is deployed on Google Cloud Platform, providing scalability, reliability, and performance while enabling me to focus on creating value rather than managing infrastructure.</p>
                        </div>

                        <div id="work-container">
                            <div class="loading">Loading work experience and projects...</div>
                        </div>
                    </section>
                </article>
            </div><!-- barba wrapper -->
            <footer class="footer" role="contentinfo">
                <p class="copyright">© 2025 Blackburn.</p>
            </footer>
        </div><!-- #fg -->
    </div><!-- .wrap -->

    <script>
        // GraphQL query to fetch portfolio data
        const query = `
            query GetPortfolio {
                portfolio {
                    workExperience {
                        id
                        company
                        position
                        location
                        startDate
                        endDate
                        description
                        isCurrent
                        companyUrl
                    }
                    projects {
                        id
                        title
                        description
                        url
                        imageUrl
                        technologies
                    }
                }
            }
        `;

        async function loadWorkData() {
            const container = document.getElementById('work-container');
            
            try {
                const response = await fetch('/graphql', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({ query })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const result = await response.json();
                
                if (result.errors) {
                    console.error('GraphQL errors:', result.errors);
                    throw new Error(result.errors[0].message || 'GraphQL query failed');
                }

                const portfolio = result.data?.portfolio;
                if (!portfolio) {
                    throw new Error('No portfolio data found in response');
                }

                let html = '';

                // Work Experience Section
                if (portfolio.workExperience && portfolio.workExperience.length > 0) {
                    html += '<div class="work-section"><h2>Work Experience</h2>';
                    portfolio.workExperience.forEach(work => {
                        const startDate = work.startDate ? new Date(work.startDate).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : 'Unknown';
                        const endDate = work.isCurrent ? 'Present' : (work.endDate ? new Date(work.endDate).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }) : 'Unknown');
                        const companyLink = work.companyUrl ? `<a href="${work.companyUrl}" target="_blank">${work.company}</a>` : work.company;
                        
                        html += `
                            <div class="work-item">
                                <h3>${work.position}${currentBadge}</h3>
                                <div class="work-meta">
                                    ${companyLink} • ${work.location || 'Remote'} • ${dateRange}
                                </div>
                                <p>${work.description || ''}</p>
                            </div>
                        `;
                    });
                    html += '</div>';
                }

                // Projects Section
                if (portfolio.projects && portfolio.projects.length > 0) {
                    html += '<div class="work-section"><h2>Featured Projects</h2>';
                    portfolio.projects.forEach(project => {
                        const projectLink = project.url ? `<a href="${project.url}" target="_blank">${project.title}</a>` : project.title;
                        const techTags = project.technologies && project.technologies.length > 0 
                            ? project.technologies.map(tech => `<span class="tech-tag">${tech}</span>`).join('')
                            : '';
                        
                        html += `
                            <div class="project-item">
                                <h3>${projectLink}</h3>
                                <p>${project.description}</p>
                                ${techTags ? `<div class="tech-tags">${techTags}</div>` : ''}
                            </div>
                        `;
                    });
                    html += '</div>';
                }

                if (!html) {
                    html = '<div class="info">No work experience or projects found.</div>';
                }

                container.innerHTML = html;

            } catch (error) {
                console.error('Error loading work data:', error);
                const errorMessage = error.message || 'Unknown error occurred';
                container.innerHTML = `
                    <div class="error">
                        <h3>Unable to load work data</h3>
                        <p>${errorMessage}</p>
                        <p><small>Please try refreshing the page or contact support if the problem persists.</small></p>
                    </div>
                `;
            }
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', loadWorkData);
    </script>
</body>

</html>